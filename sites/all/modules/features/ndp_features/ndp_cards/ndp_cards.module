<?php
/**
 * @file
 * Code for the Cards feature.
 */

include_once 'ndp_cards.features.inc';


/* NDP CUSTOMISATION - not generated by feature */

/**
 * Alter the fields used to represent an entity in the IEF table.
 *
 * The fields can be either Field API fields or properties defined through
 * hook_entity_property_info().
 *
 * @param $fields
 *   The table fields to alter. Each field is represented by an associative
 *   array containing the following keys:
 *   - type: either 'property', 'field' or 'callback' to specify how the data is
 *     defined on the related entity.
 *   - label: the title of the table field's column in the IEF table.
 *   - sanitized: for 'property' type table fields, a boolean indicating whether
 *     or not the data has already been sanitized for output; if not present or
 *     FALSE, theme_inline_entity_form_entity_table() will sanitize the data for
 *     output using check_plain().
 *   - formatter: for 'field' type table fields, the machine-name of the display
 *     formatter to use to render the field data. If this is used, then further
 *     keys will be set in the array passed to field_view_field() as the
 *     $display parameter. This allows any of the settings defined in the field
 *     formatter's hook_field_formatter_info() to be used.
 *   - weight: the sort order of the column in the IEF table.
 *   - render_callback: for 'callback' type table fields, a function name that
 *     returns a renderable array.
 * @param $context
 *   An array with the following keys:
 *   - parent_entity_type: The type of the parent entity.
 *   - parent_bundle: The bundle of the parent entity.
 *   - field_name: The name of the reference field on which IEF is operating.
 *   - entity_type: The type of the referenced entities.
 *   - allowed_bundles: Bundles allowed on the reference field.
 *
 * @see EntityInlineEntityFormController::tableFields()
 */
function ndp_cards_inline_entity_form_table_fields_alter(&$fields, $context) {
  if ($context['parent_entity_type'] == 'node' && $context['entity_type'] == 'card') {
	  // hide type - not needed
	  unset($fields['type']);
	  // change title to card title
	  $fields['title']['label'] = t('Card title');
	}
}


